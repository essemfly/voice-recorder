{% extends "base.html" %}

{% block content %}
<div id="app">
  <v-container grid-list-md text-xs-center>
    <h1 class="headline">{{script.src_title}}</h1>
    <div style="margin: 30px 0;">
      <textarea class="subheading" readonly style="width: 100%; height: 500px; border: 1.5px solid #4caf50; resize: none;">
        {{script.text}}
      </textarea>
    </div>

    <h6 class="title" style="margin: 30px 0;">녹음하실 부분을 밑의 영역에 붙여 넣어주시고, 자동 변환버튼을 눌러주세요</h6>
    <div style="margin: 30px 0;">
      <textarea class="subheading" v-model="paragraph" style="width: 100%; height: 300px; border: 1.5px solid #4caf50; resize: none;"></textarea>
    </div>
    <v-btn outline color="indigo" @click="divideParagraph(paragraph)"> 녹음목록 생성 </v-btn>

    <v-card style="margin: 30px 0;">
      <v-toolbar color="cyan" dark>
        <v-toolbar-title dark>녹음 문구 리스트</v-toolbar-title>
      </v-toolbar>
      <v-list>
        <v-list-tile v-for="sentence in sentences" :key="sentence.id" @click="">
          [[sentence]]
        </v-list-tile>
      </v-list>
    </v-card>

    <audio-recorder style="margin: 0 auto;" upload-url="YOUR_API_URL" :attempts="sentences.length" :time="0.5" :headers="headers" :before-recording="callback"
      :pause-recording="callback" :after-recording="callback" :select-record="callback" :before-upload="callback"
      :successful-upload="callback" :failed-upload="callback" />
  </v-container>
</div>


{% endblock %}

{% block javascript %}
<script type="text/javascript" src="/static/js/lib/vue-audio-recorder.min.js"></script>
<script type="text/javascript">

  Vue.use(VueAudioRecorder)

  var app = new Vue({
    el: '#app',
    delimiters: ['[[', ']]'],
    data: {
      paragraph: "",
      sentences: [],
      headers: {
        'X-Custom-Header': 'some data'
      }
    },
    methods: {
      divideParagraph: function (paragraph) {
        let lines = paragraph.split(".")
        for (let i = 0; i < lines.length; i++) {
          if (lines[i] != "") {
            this.sentences.push(lines[i])
          }
        }
      },
      callback: function (e) {
        console.log(e)
      }
    }
  });
</script>
{% endblock %}